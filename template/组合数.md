# 组合数

![image-20231213154202913](https://cdn.jsdelivr.net/gh/Ricky-Daxia/Hei_Xiu/202407252322426.png)

![image-20231213154215997](https://cdn.jsdelivr.net/gh/Ricky-Daxia/Hei_Xiu/202407252322485.png)

对（3）的推导
$$
m\cdot C_n^m = m \cdot \dfrac{n!}{m!(n-m)!}=\dfrac{n(n-1)!}{(m-1)!(n-m)!}=n \cdot C_{n-1}^{m-1}
$$


---

```c++
LL qmi(LL x, int n)
{
    LL res = 1;
    for (; n; n /= 2)
    {
        if (n % 2) res = res * x % MOD;
        x = x * x % MOD;
    }
    return res;
}

LL fac[N], inv[N];

auto init = [] {
    fac[0] = 1;
    for (int i = 1; i < N; i++)
        fac[i] = fac[i - 1] * i % MOD;
    inv[N - 1] = qmi(fac[N - 1], MOD - 2);
    for (int i = N - 1; i; i--)
        inv[i - 1] = inv[i] * i % MOD;
    return 0;
}();

LL comb(int n, int k)
{
    return (k < 0 || n < k) ? 0 : fac[n] * inv[k] % MOD * inv[n - k] % MOD;
}
```

